<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>EGFR Structures (Cartoon + Ligand)</title>
  <script src="https://3dmol.org/build/3Dmol-min.js"></script>
  <style>
    :root { --bg:#f6f7fb; --panel:#fff; --border:#e6e8ef; --accent:#f28c28; }
    html, body { height:100%; margin:0; font-family:system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:var(--bg); }
    header { background:var(--accent); color:#fff; padding:10px 16px; font-weight:700; }
    .grid {
      display:grid; gap:16px; padding:16px; 
      grid-template-columns: repeat(2, minmax(0,1fr));
    }
    .panel { background:var(--panel); border:1px solid var(--border); border-radius:12px; overflow:hidden; box-shadow:0 1px 2px rgba(0,0,0,0.04); }
    .panel h3 { margin:0; padding:10px 12px; font-size:14px; border-bottom:1px solid var(--border); color:#222; }
    .viewer { height:420px; width:100%; }
    footer { text-align:center; color:#666; font-size:12px; padding:8px 0 16px; }
    @media (max-width: 900px) { .grid { grid-template-columns: 1fr; } .viewer { height:360px; } }
  </style>
</head>
<body>
  <header>EGFR Structures (interactive) — cartoon protein + stick ligand</header>

  <div class="grid">
    <div class="panel">
      <h3>EGFR + Erlotinib (T790W)</h3>
      <div id="v1" class="viewer"></div>
    </div>
    <div class="panel">
      <h3>EGFR + Erlotinib (WT)</h3>
      <div id="v2" class="viewer"></div>
    </div>
    <div class="panel">
      <h3>EGFR + Osimertinib (C797F)</h3>
      <div id="v3" class="viewer"></div>
    </div>
    <div class="panel">
      <h3>EGFR + Osimertinib (WT)</h3>
      <div id="v4" class="viewer"></div>
    </div>
  </div>

  <footer>Drag to rotate • Scroll to zoom • If a panel is blank, check file names/paths.</footer>

  <script>
    function loadCartoonWithLigand(divId, pdbPath) {
      const viewer = $3Dmol.createViewer(divId, {backgroundColor: 'white', antialias: true});
      // Load from local file in same repo (or replace with a raw.githubusercontent URL)
      $3Dmol.download(pdbPath, viewer, { format: 'pdb' }, function () {
        // Protein as cartoon (exclude HETATM)
        viewer.setStyle({ hetflag: false }, { cartoon: { thickness: 0.4, color: 'spectrum' } });
        // Ligands (HETATM) as sticks
        viewer.setStyle({ hetflag: true }, { stick: { radius: 0.22, colorscheme: 'Jmol' } });
        // Optional: water/ions as thin lines (comment out to hide)
        // viewer.setStyle({ resn: 'HOH' }, { line: { linewidth: 1 } });

        // Focus on the ligand if present; otherwise on the whole protein
        const hasLigand = viewer.getModel().selectedAtoms({ hetflag: true }).length > 0;
        viewer.zoomTo(hasLigand ? { hetflag: true } : {});
        viewer.render();
      }, function(err){ console.error('Load error', pdbPath, err); });
    }

    // IMPORTANT: these paths must match the files in the same folder as index.html
    loadCartoonWithLigand('v1', 'EGFR_erlotinib_T790W_trimmed.pdb');
    loadCartoonWithLigand('v2', 'EGFR_erlotinib_trimmed.pdb');
    loadCartoonWithLigand('v3', 'EGFR_osimertinib_C797F_trimmed.pdb');
    loadCartoonWithLigand('v4', 'EGFR_osimertinib_trimmed.pdb');
  </script>
</body>
</html>
