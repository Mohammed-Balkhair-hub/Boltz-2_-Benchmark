<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>EGFR Structures</title>
  <script src="https://unpkg.com/3dmol/build/3Dmol-min.js"></script>
  <style>
    :root {
      --card-h: 420px;
      --gap: 14px;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: #f7f7f9;
      color: #1a1a1a;
    }
    header {
      background:#ff8a3d; color:#fff; padding:14px 18px; font-weight:700;
      letter-spacing:.2px; font-size:18px;
    }
    .grid {
      display:grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--gap);
      padding: var(--gap);
      max-width: 1400px;
      margin: 0 auto;
    }
    .card {
      background:#fff; border:1px solid #e6e6ea; border-radius:12px;
      box-shadow: 0 2px 8px rgba(0,0,0,.04);
      overflow:hidden;
      display:flex; flex-direction:column;
      min-height: var(--card-h);
    }
    .card h3 {
      margin:0; padding:10px 14px; font-size:15px; font-weight:600;
      border-bottom:1px solid #eee; background:#fdfdfd;
    }
    .viewer {
      flex:1; min-height: calc(var(--card-h) - 42px);
      position:relative;
    }
    .err {
      position:absolute; inset:0; display:none; align-items:center; justify-content:center;
      padding:16px; text-align:center; color:#b00020; background: #fff;
    }
    .footer {
      text-align:center; color:#666; font-size:12px; padding:10px 0 18px;
    }
  </style>
</head>
<body>
  <header>EGFR Structures (interactive) — drag to rotate, scroll to zoom</header>

  <div class="grid">
    <div class="card">
      <h3>EGFR + Erlotinib (T790W)</h3>
      <div id="v1" class="viewer"></div>
      <div id="e1" class="err"></div>
    </div>

    <div class="card">
      <h3>EGFR + Erlotinib (WT)</h3>
      <div id="v2" class="viewer"></div>
      <div id="e2" class="err"></div>
    </div>

    <div class="card">
      <h3>EGFR + Osimertinib (C797F)</h3>
      <div id="v3" class="viewer"></div>
      <div id="e3" class="err"></div>
    </div>

    <div class="card">
      <h3>EGFR + Osimertinib (WT)</h3>
      <div id="v4" class="viewer"></div>
      <div id="e4" class="err"></div>
    </div>
  </div>

  <div class="footer">If a panel stays blank, check file names & that GitHub Pages is enabled on this branch.</div>

  <script>
    // If your PDBs are in the same folder as this index.html, keep them as relative paths below.
    // If not, change to full raw GitHub URLs.
    const MODELS = [
      { div:'v1', err:'e1', pdb:'EGFR_erlotinib_T790W_trimmed.pdb' },
      { div:'v2', err:'e2', pdb:'EGFR_erlotinib_trimmed.pdb' },
      { div:'v3', err:'e3', pdb:'EGFR_osimertinib_C797F_trimmed.pdb' },
      { div:'v4', err:'e4', pdb:'EGFR_osimertinib_trimmed.pdb' }
    ];

    function loadViewer({div, err, pdb}) {
      const elt = document.getElementById(div);
      const errBox = document.getElementById(err);

      const config = { backgroundColor: 'white' };
      const viewer = $3Dmol.createViewer(elt, config);

      // robust loader with message on failure
      $3Dmol.download(pdb, viewer, {}, function() {
        // protein cartoon
        viewer.setStyle({protein:true}, {cartoon:{color:'spectrum'}});
        // show ligands (HETATM) as sticks
        viewer.setStyle({hetflag:true, and: [{elem:'H', invert:true}]}, {stick:{}});
        viewer.zoomTo();
        viewer.render();
      }, function(xhr) {
        // onerror — show message
        errBox.style.display = 'flex';
        errBox.innerHTML = `
          <div>
            <div style="font-weight:700;margin-bottom:6px;">Couldn’t load ${pdb}</div>
            <div style="font-size:13px;color:#888">
              Check that this file exists in the same folder and that the name matches exactly.<br/>
              If the file is in another repo/folder, use a raw.githubusercontent.com URL and make it public.
            </div>
          </div>`;
        console.error('3Dmol load error for', pdb, xhr);
      });
    }

    MODELS.forEach(loadViewer);
  </script>
</body>
</html>
